<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.542">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>PopModels - Gró-FTP - Stock assessment line - Simple pop. models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">PopModels</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#fitting-a-logistic-curve" id="toc-fitting-a-logistic-curve" class="nav-link active" data-scroll-target="#fitting-a-logistic-curve">Fitting a logistic curve</a>
  <ul class="collapse">
  <li><a href="#logistic-growth---review" id="toc-logistic-growth---review" class="nav-link" data-scroll-target="#logistic-growth---review">Logistic growth - review</a>
  <ul class="collapse">
  <li><a href="#fitting-a-logistic-growth-curve-to-elephant-data" id="toc-fitting-a-logistic-growth-curve-to-elephant-data" class="nav-link" data-scroll-target="#fitting-a-logistic-growth-curve-to-elephant-data">Fitting a logistic growth curve to elephant data</a></li>
  <li><a href="#exercise" id="toc-exercise" class="nav-link" data-scroll-target="#exercise">Exercise</a></li>
  </ul></li>
  <li><a href="#further-considerations" id="toc-further-considerations" class="nav-link" data-scroll-target="#further-considerations">Further considerations</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Gró-FTP - Stock assessment line - Simple pop. models</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="fitting-a-logistic-curve" class="level1">
<h1>Fitting a logistic curve</h1>
<section id="logistic-growth---review" class="level2">
<h2 class="anchored" data-anchor-id="logistic-growth---review">Logistic growth - review</h2>
<p>Remember this from the Simple Population Models section?</p>
<p><span class="math inline">\(N_t = N_{t-1} + r*N_{t-1}*(1-N_{t-1}/K)\)</span></p>
<ul>
<li><p>What is the functional form?</p></li>
<li><p>What are the parameters?</p></li>
<li><p>What does each parameter control?</p></li>
</ul>
<section id="fitting-a-logistic-growth-curve-to-elephant-data" class="level3">
<h3 class="anchored" data-anchor-id="fitting-a-logistic-growth-curve-to-elephant-data">Fitting a logistic growth curve to elephant data</h3>
<p>Note - here we use sum of squares as our objective function, which is not the best way to fit a non-linear model, but is used for demonstration.</p>
<p>Take a look at the website below to get familiar with the system. Then continue with the exercise.</p>
<p><a href="https://ecosystem-project.com/epopulationgrowth" class="uri">https://ecosystem-project.com/epopulationgrowth</a></p>
</section>
<section id="exercise" class="level3">
<h3 class="anchored" data-anchor-id="exercise">Exercise</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>Yrs<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1903</span>, <span class="dv">1905</span>, <span class="dv">1907</span>, <span class="dv">1926</span>, <span class="dv">1928</span>, <span class="dv">1932</span>, <span class="dv">1935</span>, <span class="dv">1939</span>, <span class="dv">1946</span>, <span class="dv">1948</span>, <span class="dv">1961</span>, <span class="dv">1964</span>, <span class="dv">1967</span>, <span class="dv">1970</span>, <span class="dv">1972</span>, <span class="dv">1974</span>, <span class="dv">1976</span>, <span class="dv">1979</span>, <span class="dv">1982</span>, <span class="dv">1985</span>, <span class="dv">1988</span>, <span class="dv">1990</span>, <span class="dv">1993</span>, <span class="dv">1996</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>Data<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">15</span>, <span class="dv">17</span>, <span class="dv">25</span>, <span class="dv">27</span>, <span class="dv">30</span>, <span class="dv">37</span>, <span class="dv">42</span>, <span class="dv">52</span>, <span class="dv">108</span>, <span class="dv">156</span>, <span class="dv">219</span>, <span class="dv">7563</span>, <span class="dv">8642</span>, <span class="dv">7378</span>, <span class="dv">7245</span>, <span class="dv">6983</span>, <span class="dv">7367</span>, <span class="dv">7689</span>, <span class="dv">8503</span>, <span class="dv">7654</span>, <span class="dv">6803</span>, <span class="dv">7204</span>, <span class="dv">7343</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(Yrs); <span class="fu">length</span>(Data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 24</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 24</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#pars, Years, and Numbers are vector arguments</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>LogisticGrowthModel<span class="ot">&lt;-</span><span class="cf">function</span>(pars, Years, Numbers, <span class="at">ReturnResults=</span>F){</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(Years)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  KK<span class="ot">&lt;-</span>pars[<span class="dv">1</span>]; rr<span class="ot">&lt;-</span>pars[<span class="dv">2</span>]; BB<span class="ot">&lt;-</span>pars[<span class="dv">3</span>]<span class="co">#assign parameters</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  TT<span class="ot">&lt;-</span>Years[<span class="dv">1</span>]<span class="sc">:</span>Years[<span class="fu">length</span>(Years)] <span class="co">#stretch out years within model so no missing years</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(TT)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  PP<span class="ot">&lt;-</span><span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"numeric"</span>, <span class="at">length =</span> <span class="fu">length</span>(TT));  <span class="co">#empty population size vector</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  DD<span class="ot">&lt;-</span><span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"numeric"</span>, <span class="at">length =</span> <span class="fu">length</span>(TT)); <span class="co">#empty population growth vector</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  II<span class="ot">&lt;-</span>rr<span class="sc">*</span>BB<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>BB<span class="sc">/</span>KK) <span class="co">#initial growth to reach year 1 from year 0</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  PP[<span class="dv">1</span>]<span class="ot">&lt;-</span>BB<span class="sc">+</span>II <span class="co"># population assignment at year 1, based on parameter BB (initial population)</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(PP)){ </span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    DD[i<span class="dv">-1</span>] <span class="ot">&lt;-</span> rr<span class="sc">*</span>PP[i<span class="dv">-1</span>]<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>PP[i<span class="dv">-1</span>]<span class="sc">/</span>KK); <span class="co">#this is dN/dt - amount the population grows based</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    <span class="co">#on conditions in the previous time step</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>    PP[i] <span class="ot">&lt;-</span> PP[i<span class="dv">-1</span>] <span class="sc">+</span> DD[i<span class="dv">-1</span>] <span class="co">#update population size</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>    } </span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(DD)</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(PP)</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>   Predictions<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">Years =</span> TT, <span class="at">Pred =</span> PP); <span class="co">#create predictions</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>   Observations<span class="ot">&lt;-</span><span class="fu">data.frame</span>(Years, Numbers) <span class="co">#store observations in data frame</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>   Results<span class="ot">&lt;-</span><span class="fu">merge</span>(Predictions, Observations, <span class="at">by =</span> <span class="st">"Years"</span>) <span class="co">#match Predictions and Observations by Year</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>   SS<span class="ot">&lt;-</span><span class="fu">sum</span>((Results<span class="sc">$</span>Numbers <span class="sc">-</span> Results<span class="sc">$</span>Pred)<span class="sc">^</span><span class="dv">2</span>) <span class="co">#calculate sum of squares: sum((obs - pred)^2)</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>   <span class="fu">print</span>(<span class="st">'Results'</span>)</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>   <span class="fu">print</span>(Results)</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(ReturnResults<span class="sc">==</span>T){ <span class="fu">return</span>(<span class="fu">list</span>(Predictions, SS))} <span class="cf">else</span> {<span class="fu">return</span>(SS)}</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>   <span class="co">#controls options for what is returned from function</span></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>   }</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a><span class="co">#LogisticGrowthModel(c(7500,0.5), Yrs, Data, t=0, ReturnResults=T) ERROR</span></span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a><span class="fu">LogisticGrowthModel</span>(<span class="fu">c</span>(<span class="dv">7500</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">Years=</span>Yrs, <span class="at">Numbers=</span>Data, <span class="at">ReturnResults=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1903 1905 1907 1926 1928 1932 1935 1939 1946 1948 1961 1964 1967 1970 1972
[16] 1974 1976 1979 1982 1985 1988 1990 1993 1996
 [1] 1903 1904 1905 1906 1907 1908 1909 1910 1911 1912 1913 1914 1915 1916 1917
[16] 1918 1919 1920 1921 1922 1923 1924 1925 1926 1927 1928 1929 1930 1931 1932
[31] 1933 1934 1935 1936 1937 1938 1939 1940 1941 1942 1943 1944 1945 1946 1947
[46] 1948 1949 1950 1951 1952 1953 1954 1955 1956 1957 1958 1959 1960 1961 1962
[61] 1963 1964 1965 1966 1967 1968 1969 1970 1971 1972 1973 1974 1975 1976 1977
[76] 1978 1979 1980 1981 1982 1983 1984 1985 1986 1987 1988 1989 1990 1991 1992
[91] 1993 1994 1995 1996
 [1] 7.498167e-01 1.124538e+00 1.686385e+00 2.528629e+00 3.790811e+00
 [6] 5.681422e+00 8.511361e+00 1.274285e+01 1.906000e+01 2.846841e+01
[11] 4.243079e+01 6.304051e+01 9.321762e+01 1.368693e+02 1.988625e+02
[16] 2.844839e+02 3.978030e+02 5.381664e+02 6.944762e+02 8.391165e+02
[21] 9.280905e+02 9.171569e+02 7.935266e+02 5.960632e+02 3.925182e+02
[26] 2.326112e+02 1.281541e+02 6.752262e+01 3.469589e+01 1.759173e+01
[31] 8.858151e+00 4.444818e+00 2.226367e+00 1.114176e+00 5.573361e-01
[36] 2.787302e-01 1.393806e-01 6.969421e-02 3.484807e-02 1.742428e-02
[41] 8.712201e-03 4.356116e-03 2.178062e-03 1.089032e-03 5.445161e-04
[46] 2.722581e-04 1.361291e-04 6.806454e-05 3.403227e-05 1.701614e-05
[51] 8.508068e-06 4.254034e-06 2.127016e-06 1.063508e-06 5.317542e-07
[56] 2.658773e-07 1.329387e-07 6.646891e-08 3.323467e-08 1.661754e-08
[61] 8.308770e-09 4.154177e-09 2.076672e-09 1.038752e-09 5.191680e-10
[66] 2.597922e-10 1.294798e-10 6.494805e-11 3.289036e-11 1.623701e-11
[71] 8.326673e-12 4.163336e-12 1.665335e-12 8.326673e-13 4.163336e-13
[76] 4.163336e-13 4.163336e-13 4.163336e-13 4.163336e-13 4.163336e-13
[81] 4.163336e-13 4.163336e-13 4.163336e-13 4.163336e-13 4.163336e-13
[86] 4.163336e-13 4.163336e-13 4.163336e-13 4.163336e-13 4.163336e-13
[91] 4.163336e-13 4.163336e-13 4.163336e-13 0.000000e+00
 [1]    1.499933    2.249750    3.374288    5.060672    7.589301   11.380112
 [7]   17.061534   25.572895   38.315744   57.375743   85.844149  128.274942
[13]  191.315449  284.533067  421.402329  620.264832  904.748684 1302.551681
[19] 1840.718129 2535.194312 3374.310788 4302.401296 5219.558149 6013.084739
[25] 6609.147903 7001.666121 7234.277284 7362.431404 7429.954028 7464.649918
[31] 7482.241650 7491.099801 7495.544620 7497.770987 7498.885162 7499.442498
[37] 7499.721228 7499.860609 7499.930303 7499.965151 7499.982576 7499.991288
[43] 7499.995644 7499.997822 7499.998911 7499.999455 7499.999728 7499.999864
[49] 7499.999932 7499.999966 7499.999983 7499.999991 7499.999996 7499.999998
[55] 7499.999999 7499.999999 7500.000000 7500.000000 7500.000000 7500.000000
[61] 7500.000000 7500.000000 7500.000000 7500.000000 7500.000000 7500.000000
[67] 7500.000000 7500.000000 7500.000000 7500.000000 7500.000000 7500.000000
[73] 7500.000000 7500.000000 7500.000000 7500.000000 7500.000000 7500.000000
[79] 7500.000000 7500.000000 7500.000000 7500.000000 7500.000000 7500.000000
[85] 7500.000000 7500.000000 7500.000000 7500.000000 7500.000000 7500.000000
[91] 7500.000000 7500.000000 7500.000000 7500.000000
[1] "Results"
   Years        Pred Numbers
1   1903    1.499933      12
2   1905    3.374288      15
3   1907    7.589301      17
4   1926 6013.084739      25
5   1928 7001.666121      27
6   1932 7464.649918      30
7   1935 7495.544620      37
8   1939 7499.721228      42
9   1946 7499.997822      52
10  1948 7499.999455     108
11  1961 7500.000000     156
12  1964 7500.000000     219
13  1967 7500.000000    7563
14  1970 7500.000000    8642
15  1972 7500.000000    7378
16  1974 7500.000000    7245
17  1976 7500.000000    6983
18  1979 7500.000000    7367
19  1982 7500.000000    7689
20  1985 7500.000000    8503
21  1988 7500.000000    7654
22  1990 7500.000000    6803
23  1993 7500.000000    7204
24  1996 7500.000000    7343</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
   Years        Pred
1   1903    1.499933
2   1904    2.249750
3   1905    3.374288
4   1906    5.060672
5   1907    7.589301
6   1908   11.380112
7   1909   17.061534
8   1910   25.572895
9   1911   38.315744
10  1912   57.375743
11  1913   85.844149
12  1914  128.274942
13  1915  191.315449
14  1916  284.533067
15  1917  421.402329
16  1918  620.264832
17  1919  904.748684
18  1920 1302.551681
19  1921 1840.718129
20  1922 2535.194312
21  1923 3374.310788
22  1924 4302.401296
23  1925 5219.558149
24  1926 6013.084739
25  1927 6609.147903
26  1928 7001.666121
27  1929 7234.277284
28  1930 7362.431404
29  1931 7429.954028
30  1932 7464.649918
31  1933 7482.241650
32  1934 7491.099801
33  1935 7495.544620
34  1936 7497.770987
35  1937 7498.885162
36  1938 7499.442498
37  1939 7499.721228
38  1940 7499.860609
39  1941 7499.930303
40  1942 7499.965151
41  1943 7499.982576
42  1944 7499.991288
43  1945 7499.995644
44  1946 7499.997822
45  1947 7499.998911
46  1948 7499.999455
47  1949 7499.999728
48  1950 7499.999864
49  1951 7499.999932
50  1952 7499.999966
51  1953 7499.999983
52  1954 7499.999991
53  1955 7499.999996
54  1956 7499.999998
55  1957 7499.999999
56  1958 7499.999999
57  1959 7500.000000
58  1960 7500.000000
59  1961 7500.000000
60  1962 7500.000000
61  1963 7500.000000
62  1964 7500.000000
63  1965 7500.000000
64  1966 7500.000000
65  1967 7500.000000
66  1968 7500.000000
67  1969 7500.000000
68  1970 7500.000000
69  1971 7500.000000
70  1972 7500.000000
71  1973 7500.000000
72  1974 7500.000000
73  1975 7500.000000
74  1976 7500.000000
75  1977 7500.000000
76  1978 7500.000000
77  1979 7500.000000
78  1980 7500.000000
79  1981 7500.000000
80  1982 7500.000000
81  1983 7500.000000
82  1984 7500.000000
83  1985 7500.000000
84  1986 7500.000000
85  1987 7500.000000
86  1988 7500.000000
87  1989 7500.000000
88  1990 7500.000000
89  1991 7500.000000
90  1992 7500.000000
91  1993 7500.000000
92  1994 7500.000000
93  1995 7500.000000
94  1996 7500.000000

[[2]]
[1] 471423138</code></pre>
</div>
</div>
<p>Now we would like to fit this model by minimizing the objective function using algorithms implemented in the ‘optim’ function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>?optim <span class="co"># this function tries different parameter values to minimize the output of </span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#LogisticGrowthModel. The output is the sum of squares.</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>OptPars1<span class="ot">&lt;-</span><span class="fu">optim</span>(<span class="fu">c</span>(<span class="dv">7500</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), LogisticGrowthModel, <span class="at">method =</span> <span class="st">'L-BFGS-B'</span>, <span class="at">Years =</span> Yrs, <span class="at">Numbers =</span> Data, <span class="at">lower =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">0</span>,<span class="fl">0.8</span>), <span class="at">upper =</span> <span class="fu">c</span>(<span class="dv">10000</span>, <span class="dv">1</span>,<span class="dv">100</span>), <span class="at">control =</span> <span class="fu">list</span>(<span class="at">maxit =</span> <span class="dv">50000</span>))</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>OptPars1</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>OptPars2<span class="ot">&lt;-</span><span class="fu">optim</span>(<span class="fu">c</span>(<span class="dv">7500</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), LogisticGrowthModel, <span class="at">Years =</span> Yrs, <span class="at">Numbers =</span> Data, <span class="at">control =</span> <span class="fu">list</span>(<span class="at">maxit =</span> <span class="dv">50000</span>))</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>OptPars2</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>Predictions1<span class="ot">&lt;-</span><span class="fu">LogisticGrowthModel</span>(OptPars1<span class="sc">$</span>par, Yrs, Data, <span class="at">ReturnResults=</span>T)[[<span class="dv">1</span>]]</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>Predictions2<span class="ot">&lt;-</span><span class="fu">LogisticGrowthModel</span>(OptPars2<span class="sc">$</span>par, Yrs, Data, <span class="at">ReturnResults=</span>T)[[<span class="dv">1</span>]]</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Data<span class="sc">~</span>Yrs, <span class="at">pch =</span> <span class="st">"*"</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8000</span>), <span class="at">ylab =</span> <span class="st">''</span>, <span class="at">xlab =</span> <span class="st">''</span>)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new =</span> T)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Pred<span class="sc">~</span>Years, <span class="at">data =</span> Predictions1, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8000</span>))</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(Pred<span class="sc">~</span>Years, <span class="at">data =</span> Predictions2, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Now try to figure out the best time lag as shown in the on-line example. </span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Hint: plot SS as it relates to the time lag value. SS is your sums of </span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="co"># squares, so the value with the lowest sum of squares is the one you want. </span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Try lag values of 0 - 5. To include a lag, use the next function instead. </span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that there is now an additional parameter for lag t.</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>LogisticGrowthModelLag<span class="ot">&lt;-</span><span class="cf">function</span>(pars, Years, Numbers, <span class="at">t=</span><span class="dv">0</span>, <span class="at">ReturnResults=</span>F){</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>  KK<span class="ot">&lt;-</span>pars[<span class="dv">1</span>]; rr<span class="ot">&lt;-</span>pars[<span class="dv">2</span>]; BB<span class="ot">&lt;-</span>pars[<span class="dv">3</span>]</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>  TT<span class="ot">&lt;-</span>Years[<span class="dv">1</span>]<span class="sc">:</span>Years[<span class="fu">length</span>(Years)]</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>  PP<span class="ot">&lt;-</span><span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"numeric"</span>, <span class="at">length =</span> <span class="fu">length</span>(TT));</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>  DD<span class="ot">&lt;-</span><span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"numeric"</span>, <span class="at">length =</span> <span class="fu">length</span>(TT)); </span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>  II<span class="ot">&lt;-</span>rr<span class="sc">*</span>BB<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>BB<span class="sc">/</span>KK)</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>  PP[<span class="dv">1</span>]<span class="ot">&lt;-</span>BB<span class="sc">+</span>II</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>  <span class="co">#implementing Logistic Growth for Years with no lagged Numbers data</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(t<span class="sc">&gt;</span><span class="dv">0</span>){</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>(t<span class="sc">+</span><span class="dv">1</span>)){ </span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>      DD[i<span class="dv">-1</span>]<span class="ot">&lt;-</span> rr<span class="sc">*</span>PP[i<span class="dv">-1</span>]<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>PP[i<span class="dv">-1</span>]<span class="sc">/</span>KK);</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>      PP[i]<span class="ot">&lt;-</span>PP[i<span class="dv">-1</span>] <span class="sc">+</span> DD[i<span class="dv">-1</span>]</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>  <span class="co">#implementing Lagged growth</span></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> (t<span class="sc">+</span><span class="dv">2</span>)<span class="sc">:</span><span class="fu">length</span>(PP)){ </span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>    DD[i<span class="dv">-1</span>]<span class="ot">&lt;-</span> rr<span class="sc">*</span>PP[i<span class="dv">-1</span>]<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>PP[i<span class="dv">-1</span><span class="sc">-</span>t]<span class="sc">/</span>KK); </span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>    PP[i]<span class="ot">&lt;-</span>PP[i<span class="dv">-1</span>] <span class="sc">+</span> DD[i<span class="dv">-1</span>]</span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>  <span class="co">#print(PP) </span></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>  Predictions<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">Years =</span> TT, <span class="at">Pred =</span> PP); Observations<span class="ot">&lt;-</span><span class="fu">data.frame</span>(Years, Numbers)</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>  Results<span class="ot">&lt;-</span><span class="fu">merge</span>(Predictions, Observations, <span class="at">by =</span> <span class="st">"Years"</span>)</span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>  SS<span class="ot">&lt;-</span><span class="fu">sum</span>((Results<span class="sc">$</span>Numbers <span class="sc">-</span> Results<span class="sc">$</span>Pred)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(ReturnResults<span class="sc">==</span>T){ <span class="fu">return</span>(<span class="fu">list</span>(Predictions, SS))} <span class="cf">else</span> {<span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">is.infinite</span>(SS), <span class="dv">10000000000</span>, SS))}</span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a><span class="fu">LogisticGrowthModelLag</span>(OptPars1<span class="sc">$</span>par, <span class="at">t=</span><span class="dv">3</span>,Yrs, Data, <span class="at">ReturnResults=</span>T)</span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a><span class="fu">LogisticGrowthModelLag</span>(OptPars2<span class="sc">$</span>par, <span class="at">t=</span><span class="dv">3</span>,Yrs, Data, <span class="at">ReturnResults=</span>T)</span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>SS1<span class="ot">&lt;-</span>SS2<span class="ot">&lt;-</span><span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"numeric"</span>, <span class="at">length =</span> <span class="dv">6</span>)</span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>OptPars1_list<span class="ot">&lt;-</span>OptPars2_list<span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">6</span>){</span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>  OptPars1_list[[i<span class="sc">+</span><span class="dv">1</span>]]<span class="ot">&lt;-</span><span class="fu">try</span>(<span class="fu">optim</span>(OptPars1<span class="sc">$</span>par, <span class="at">fn=</span>LogisticGrowthModelLag, <span class="at">t=</span>i, <span class="at">method =</span> <span class="st">'L-BFGS-B'</span>, <span class="at">Years =</span> Yrs, <span class="at">Numbers =</span> Data, <span class="at">lower =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">0</span>,<span class="fl">0.8</span>), <span class="at">upper =</span> <span class="fu">c</span>(<span class="dv">10000</span>, <span class="dv">1</span>,<span class="dv">100</span>), <span class="at">control =</span> <span class="fu">list</span>(<span class="at">maxit =</span> <span class="dv">50000</span>)), <span class="at">silent=</span>T)</span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>  OptPars2_list[[i<span class="sc">+</span><span class="dv">1</span>]]<span class="ot">&lt;-</span><span class="fu">try</span>(<span class="fu">optim</span>(OptPars2<span class="sc">$</span>par, <span class="at">fn=</span>LogisticGrowthModelLag, <span class="at">t=</span>i, <span class="at">Years =</span> Yrs, <span class="at">Numbers =</span> Data, <span class="at">control =</span> <span class="fu">list</span>(<span class="at">maxit =</span> <span class="dv">50000</span>)),<span class="at">silent=</span>T)</span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>  SS1[i<span class="sc">+</span><span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">try</span>(OptPars1_list[[i<span class="sc">+</span><span class="dv">1</span>]]<span class="sc">$</span>value<span class="sc">/</span><span class="dv">1000000</span>,<span class="at">silent=</span>T )</span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a>  SS2[i<span class="sc">+</span><span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">try</span>(OptPars2_list[[i<span class="sc">+</span><span class="dv">1</span>]]<span class="sc">$</span>value<span class="sc">/</span><span class="dv">1000000</span>,<span class="at">silent=</span>T )</span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a>SS1 </span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a>SS2</span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a><span class="co">#Q - The time lag corresponding with the minimum SS is the best. What is time lag is that?</span></span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a><span class="co">#That is, which would you choose if the best model by least squares (SS)?</span></span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(SS1<span class="sc">~</span><span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">6</span>))</span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(SS2<span class="sc">~</span><span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">6</span>))</span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-77"><a href="#cb7-77" aria-hidden="true" tabindex="-1"></a><span class="co">#Q - BUT, this is what happens with lag = 5. Why? (Compare plots with lag = 0 - 4)</span></span>
<span id="cb7-78"><a href="#cb7-78" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb7-79"><a href="#cb7-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-80"><a href="#cb7-80" aria-hidden="true" tabindex="-1"></a>OptPars<span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb7-81"><a href="#cb7-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-82"><a href="#cb7-82" aria-hidden="true" tabindex="-1"></a>OptPars<span class="ot">&lt;-</span><span class="fu">optim</span>(<span class="fu">c</span>(<span class="dv">7500</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), LogisticGrowthModelLag, <span class="at">t=</span><span class="dv">5</span>, <span class="at">Years =</span> Yrs, <span class="at">Numbers =</span> Data)</span>
<span id="cb7-83"><a href="#cb7-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-84"><a href="#cb7-84" aria-hidden="true" tabindex="-1"></a>Predictions<span class="ot">&lt;-</span><span class="fu">LogisticGrowthModelLag</span>(<span class="fu">c</span>(OptPars<span class="sc">$</span>par), <span class="at">t=</span><span class="dv">5</span>,Yrs, Data, <span class="at">ReturnResults=</span>T)[[<span class="dv">1</span>]]</span>
<span id="cb7-85"><a href="#cb7-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-86"><a href="#cb7-86" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Data<span class="sc">~</span>Yrs, <span class="at">pch =</span> <span class="st">"*"</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8000</span>), <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">''</span>)</span>
<span id="cb7-87"><a href="#cb7-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-88"><a href="#cb7-88" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new =</span> T)</span>
<span id="cb7-89"><a href="#cb7-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-90"><a href="#cb7-90" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Pred<span class="sc">~</span>Years, <span class="at">data =</span> Predictions, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8000</span>))</span>
<span id="cb7-91"><a href="#cb7-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-92"><a href="#cb7-92" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">'Lag 5'</span>)</span>
<span id="cb7-93"><a href="#cb7-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-94"><a href="#cb7-94" aria-hidden="true" tabindex="-1"></a>Predictions<span class="ot">&lt;-</span><span class="fu">LogisticGrowthModelLag</span>(<span class="fu">c</span>(OptPars1_list[[<span class="dv">6</span>]]<span class="sc">$</span>par), <span class="at">t=</span><span class="dv">6-1</span>,Yrs, Data, <span class="at">ReturnResults=</span>T)[[<span class="dv">1</span>]]</span>
<span id="cb7-95"><a href="#cb7-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-96"><a href="#cb7-96" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(Pred<span class="sc">~</span>Years, <span class="at">data =</span> Predictions, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb7-97"><a href="#cb7-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-98"><a href="#cb7-98" aria-hidden="true" tabindex="-1"></a><span class="fu">LogisticGrowthModelLag</span>(OptPars2<span class="sc">$</span>par, <span class="at">t=</span><span class="dv">5</span>,Yrs, Data, <span class="at">ReturnResults=</span>T)</span>
<span id="cb7-99"><a href="#cb7-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-100"><a href="#cb7-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-101"><a href="#cb7-101" aria-hidden="true" tabindex="-1"></a><span class="co">#...compared with lag = 3</span></span>
<span id="cb7-102"><a href="#cb7-102" aria-hidden="true" tabindex="-1"></a>OptPars<span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb7-103"><a href="#cb7-103" aria-hidden="true" tabindex="-1"></a>OptPars<span class="ot">&lt;-</span><span class="fu">optim</span>(<span class="fu">c</span>(<span class="dv">7500</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), LogisticGrowthModelLag, <span class="at">t=</span><span class="dv">3</span>, <span class="at">Years =</span> Yrs, <span class="at">Numbers =</span> Data)</span>
<span id="cb7-104"><a href="#cb7-104" aria-hidden="true" tabindex="-1"></a>Predictions<span class="ot">&lt;-</span><span class="fu">LogisticGrowthModelLag</span>(<span class="fu">c</span>(OptPars<span class="sc">$</span>par), <span class="at">t=</span><span class="dv">3</span>,Yrs, Data, <span class="at">ReturnResults=</span>T)[[<span class="dv">1</span>]]</span>
<span id="cb7-105"><a href="#cb7-105" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Data<span class="sc">~</span>Yrs, <span class="at">pch =</span> <span class="st">"*"</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8000</span>), <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">''</span>)</span>
<span id="cb7-106"><a href="#cb7-106" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new =</span> T)</span>
<span id="cb7-107"><a href="#cb7-107" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Pred<span class="sc">~</span>Years, <span class="at">data =</span> Predictions, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8000</span>))</span>
<span id="cb7-108"><a href="#cb7-108" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">'Lag 3'</span>)</span>
<span id="cb7-109"><a href="#cb7-109" aria-hidden="true" tabindex="-1"></a>Predictions<span class="ot">&lt;-</span><span class="fu">LogisticGrowthModelLag</span>(<span class="fu">c</span>(OptPars1_list[[<span class="dv">4</span>]]<span class="sc">$</span>par), <span class="at">t=</span><span class="dv">4-1</span>,Yrs, Data, <span class="at">ReturnResults=</span>T)[[<span class="dv">1</span>]]</span>
<span id="cb7-110"><a href="#cb7-110" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(Pred<span class="sc">~</span>Years, <span class="at">data =</span> Predictions, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb7-111"><a href="#cb7-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-112"><a href="#cb7-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-113"><a href="#cb7-113" aria-hidden="true" tabindex="-1"></a><span class="co">#...and no lag = 0</span></span>
<span id="cb7-114"><a href="#cb7-114" aria-hidden="true" tabindex="-1"></a>OptPars<span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb7-115"><a href="#cb7-115" aria-hidden="true" tabindex="-1"></a>OptPars<span class="ot">&lt;-</span><span class="fu">optim</span>(<span class="fu">c</span>(<span class="dv">7500</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), LogisticGrowthModelLag, <span class="at">t=</span><span class="dv">0</span>, <span class="at">Years =</span> Yrs, <span class="at">Numbers =</span> Data)</span>
<span id="cb7-116"><a href="#cb7-116" aria-hidden="true" tabindex="-1"></a>Predictions<span class="ot">&lt;-</span><span class="fu">LogisticGrowthModelLag</span>(<span class="fu">c</span>(OptPars<span class="sc">$</span>par), <span class="at">t=</span><span class="dv">0</span>,Yrs, Data, <span class="at">ReturnResults=</span>T)[[<span class="dv">1</span>]]</span>
<span id="cb7-117"><a href="#cb7-117" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Data<span class="sc">~</span>Yrs, <span class="at">pch =</span> <span class="st">"*"</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8000</span>), <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">''</span>)</span>
<span id="cb7-118"><a href="#cb7-118" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new =</span> T)</span>
<span id="cb7-119"><a href="#cb7-119" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Pred<span class="sc">~</span>Years, <span class="at">data =</span> Predictions, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8000</span>))</span>
<span id="cb7-120"><a href="#cb7-120" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">'Lag 0'</span>)</span>
<span id="cb7-121"><a href="#cb7-121" aria-hidden="true" tabindex="-1"></a>Predictions<span class="ot">&lt;-</span><span class="fu">LogisticGrowthModelLag</span>(<span class="fu">c</span>(OptPars1_list[[<span class="dv">1</span>]]<span class="sc">$</span>par), <span class="at">t=</span><span class="dv">1-1</span>,Yrs, Data, <span class="at">ReturnResults=</span>T)[[<span class="dv">1</span>]]</span>
<span id="cb7-122"><a href="#cb7-122" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(Pred<span class="sc">~</span>Years, <span class="at">data =</span> Predictions, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb7-123"><a href="#cb7-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-124"><a href="#cb7-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-125"><a href="#cb7-125" aria-hidden="true" tabindex="-1"></a><span class="co">#Q - Which one fits the data best?</span></span>
<span id="cb7-126"><a href="#cb7-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-127"><a href="#cb7-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-128"><a href="#cb7-128" aria-hidden="true" tabindex="-1"></a><span class="co">#TAKE HOME MESSAGES</span></span>
<span id="cb7-129"><a href="#cb7-129" aria-hidden="true" tabindex="-1"></a><span class="co">#- the optimizer matters</span></span>
<span id="cb7-130"><a href="#cb7-130" aria-hidden="true" tabindex="-1"></a><span class="co">#- the starting values matter</span></span>
<span id="cb7-131"><a href="#cb7-131" aria-hidden="true" tabindex="-1"></a><span class="co">#- the biology matters</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="further-considerations" class="level2">
<h2 class="anchored" data-anchor-id="further-considerations">Further considerations</h2>
<ul>
<li>What biological and ecological factors contribute to r and K?</li>
</ul>
<!-- -->
<ul>
<li>What population characteristic is the most important for natural resource management?</li>
<li>How to detect this without biological/ecological data?</li>
<li>Draw a graph of how population growth rate (<span class="math inline">\(dN/dt\)</span>) changes over time for the case studies of 1) exponential and 2) logistic growth. How does the density dependent term <span class="math inline">\((1-N/K)\)</span> change over time?</li>
<li>What species would be difficult to represent with this?</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>